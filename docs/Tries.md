# Tire树：实现搜索引擎的智能提示功能

搜索引擎的关键字查询提示功能一定不陌生，这就是用 Trie 树实现的。

# 什么是 Trie 树？

Trie 树也叫 “字典树”。顾名思义就是一个树形结构，它是一种专门处理字符串匹配的数据结构，用来解决在一组字符串集合中快速查找某个字符串的问题。

当然，这种查找匹配问题可以有很多种方法，比如散列表，红黑树，或者是我们之前讲的字符串匹配算法。但是 Trie 树在这个问题的解决方面，有它独有的优势。

Trie 树长什么样子。我们举个例子来说明一下，假设有这么一组字符串：how，hi，her，hello，so，see。我们希望在里面多次查找某个字符串是否存在。如果每次查找都要拿查找的字符串与这 6 个字符串一一比对，无疑效率是非常低的。有没有更好的办法？

我们可以对这 6 个字符串进行预处理，把这 6 个字符串拆开成每个字符，存在一个树型结构当中，之后每次查找都是在这个树型结构查找的。其本质就是，利用这些字符串之间的公共前缀，将重复的前缀合并在一起。最后构成下面的图树型结构。

![img](https://static001.geekbang.org/resource/image/28/32/280fbc0bfdef8380fcb632af39e84b32.jpg)

其中，跟结点是不含任何信息的，每个节点就是一个字符，从跟结点到红色结点（红色不一定都是叶子结点）代表一个字符串。

为了更加理解 Trie 树是怎么造出来的，下面是构造过程图。构成 Trie 树的每一步都是相当于往树结构插入一条数据。当所有字符串插入完成之后，Trie 树就构造好了。

![img](https://static001.geekbang.org/resource/image/f8/6c/f848a7d8bda3d4f8bb4a7cbfaabab66c.jpg)

我们在 Trie 树找到要找的字符串，比如直接查 “her”，那我们就要拆开该字符串为 h，e，r，然后从跟结点开始匹配。那么，就能得知左边的那条线是最佳路径。

如果我们查找的是 “he”？是否还适用上面说的方法，从跟结点开始，沿着某条路径匹配。我们从图中可以看到字符串 "he" 的位置，但是路径的最后一个结点 “e” 并不是口红。也就是说，“he” 是某个字符串的前缀子串，但并不能完全匹配任何字符串。

# 如何实现 Trie 树

从刚刚的介绍来看，Trie 树主要有两个操作：一是将字符串构造成 Trie 树，即就是将字符串插入到树结构的过程。二是在 Trie 树中查找一个字符串。

在此之后，我们再来看下，Trie 树数据如何保存。

从图中可以看出，Trie 树一个多叉树结构。我们知道二叉树是有左右两个结点是通过指针存储的，那么在代码中如何表示存储一个结点的所有子结点的指针呢？

```c#
public class BinaryTreeNode {
    public char Data { get; set; }
    public BinaryTreeNode Left { get; set; }
    public BinaryTreeNode Right { get; set; }
}
```

我们先用散列表的思想来存储这些子结点的指针——下标与字符映射的数组。举个例子

![img](https://static001.geekbang.org/resource/image/f5/35/f5a4a9cb7f0fe9dcfbf29eb1e5da6d35.jpg)

